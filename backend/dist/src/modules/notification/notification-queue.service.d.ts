import { OnModuleInit, OnModuleDestroy } from '@nestjs/common';
import { PrismaService } from '../../shared/database/prisma.service';
import { NotificationService } from './notification.service';
import { EmailProvider } from './providers/email.provider';
import { SMSProvider } from './providers/sms.provider';
import { WhatsAppProvider } from './providers/whatsapp.provider';
export interface QueueJob {
    id: string;
    notificationId: string;
    type: 'email' | 'sms' | 'whatsapp' | 'push' | 'in_app';
    priority: 'low' | 'normal' | 'high' | 'urgent';
    scheduledAt?: Date;
    maxRetries: number;
    retryCount: number;
    data: any;
    status: 'queued' | 'processing' | 'completed' | 'failed' | 'cancelled';
    createdAt: Date;
    updatedAt: Date;
    nextRetryAt?: Date;
    lastError?: string;
}
export declare class NotificationQueueService implements OnModuleInit, OnModuleDestroy {
    private readonly prisma;
    private readonly notificationService;
    private readonly emailProvider;
    private readonly smsProvider;
    private readonly whatsappProvider;
    private readonly logger;
    private isProcessing;
    private processingInterval;
    private readonly processingIntervalMs;
    private readonly maxConcurrentJobs;
    private activeJobs;
    constructor(prisma: PrismaService, notificationService: NotificationService, emailProvider: EmailProvider, smsProvider: SMSProvider, whatsappProvider: WhatsAppProvider);
    onModuleInit(): Promise<void>;
    onModuleDestroy(): Promise<void>;
    addToQueue(notificationData: {
        notificationId: string;
        type: 'email' | 'sms' | 'whatsapp' | 'push' | 'in_app';
        priority: 'low' | 'normal' | 'high' | 'urgent';
        scheduledAt?: Date;
        data: any;
    }): Promise<void>;
    cancelJob(jobId: string): Promise<void>;
    retryJob(jobId: string): Promise<void>;
    getQueueStats(): Promise<{
        totalJobs: number;
        queuedJobs: number;
        processingJobs: number;
        completedJobs: number;
        failedJobs: number;
        cancelledJobs: number;
        averageProcessingTime: number;
        jobsByType: Record<string, number>;
        jobsByPriority: Record<string, number>;
    }>;
    cleanupOldJobs(daysOld?: number): Promise<number>;
    restartProcessing(): Promise<void>;
    private startProcessing;
    private stopProcessing;
    private processQueue;
    private processJob;
    private executeJob;
    private sendEmail;
    private sendSMS;
    private sendWhatsApp;
    private sendPush;
    private sendInApp;
    private getJobsToProcess;
    private saveJob;
    private getJob;
    private calculateBackoffDelay;
    private updateNotificationStatus;
}
